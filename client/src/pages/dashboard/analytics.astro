---
import DashboardLayout from "@/layouts/dashboard-layout.astro";
import EmptyPlaceholder from "@/components/placeholder/empty-placeholder.astro";
import PlaceholderTitle from "@/components/placeholder/placeholder-title.astro";
import PlaceholderDescription from "@/components/placeholder/placeholder-description.astro";
import PlaceholderIcon from "@/components/placeholder/placeholder-icon.astro";

const cookie = Astro.cookies.get("auth_token");
// const BASE_URL = import.meta.env.PUBLIC_API

if (!cookie?.value) {
  const params = new URLSearchParams({
    redirectedFrom: "/dashboard/analytics",
  });
  return Astro.redirect(`/login?${params.toString()}`);
}

// const posts: Post[] = await fetch(
// `${BASE_URL}/posts/current-user`, {
//     method: "GET",
//     headers: {
//       'Cookie': `auth_token=${cookie?.value}`,
//     },
//   })
//   .then(async (response) => await response.json())
//   .then((data) => (data.data as Post[]).filter((p) => p.is_draft))
//   .catch((error) => {
//     console.error(error)
//     return []
//   })
---

<DashboardLayout title="Analytics">
  <div class="my-10">
    <h1 class="text-2xl mb-2 font-bold">Your Posts analytics</h1>
    <p class="text-gray-600">This is where you will find your analytics.</p>
  </div>

  <div>
    <EmptyPlaceholder>
      <PlaceholderIcon name="tabler:file-search" class="text-slate-600" />
      <PlaceholderTitle>TODO</PlaceholderTitle>
      <PlaceholderDescription>
        Analytics are not available yet.
      </PlaceholderDescription>
    </EmptyPlaceholder>
  </div>
</DashboardLayout>
